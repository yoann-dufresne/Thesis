
# Vers la biologie de synthèse

Depuis quelques années, les bactéries développent de plus en plus de résistances aux antibiotiques utilisés en médecine animale.
Les NRP étant une source très riche d'antibiotiques, de nombreuses équipes essayent de créer de nouvelles molécules à partir de ceux-ci.
C'est dans le but de contribuer à la création de ces nouvelles molécules que nous allons ici aborder la thématique de la biologie de synthèse.
La biologie de synthèse est un domaine qui vise à modifier des organismes pour les pousser à effectuer des tâches que nous souhaitons.
Dans notre cas le but est de faire produire en masse par une bactérie, des NRP qui nous intéressent.

Cette section va parler de la suite du travail présenté jusqu'à présent.
L'annotation NRP n'est pas une fin en soit mais une donnée précieuse pour décrire les voies de synthèse.
La question derrière cette partie est : Est-il possible de construire des voies de synthèse à partir d'un graphe monomérique voulu ?
Comme nous le verrons par la suite, cette question est beaucoup trop large pour l'avancée des connaissances actuelles.
La première étape pour les NRPS sera de mettre en relation les NRP avec le cluster de géne les produisant.
Cette information double sera très utile par la suite pour tout modèle d'apprentissage qui souhaiterait designer des voies de synthèse.
L'archivage de ces binômes n'étant pour le moment pas fait, nous proposerons d'utiliser Norine pour référencer les informations de production.



TODO : parler de notre méthode en introduisant état de l'art.
Dans cette section nous allons parler de la modification de bactéries pour la production de peptides non ribosomiques nouveaux.


## L'existant

Commençons par un tour d'horizon des travaux de ce domaine.
Nous nous appuierons sur le travail de revue réalisé par Hajo Kries~\cite{}.
Effectuons un survol des techniques en commançant par de petites modifications monomériques pour arriver finalement à la création totale d'un NRP.


### Les modifications peptidiques
% Recent advances in engineering nonribosomal peptide assembly lines
% Ribosome-independent biosynthesis of biologically active peptides: Application of synthetic biology to generate structural diversity

L'une des approches pour obtenir de nouvelles structures peptidiques est de faire varier les structures existantes.
La structure peut être modifiée post-synthèse NRPS, par des enzymes présentes dans le cluster de gènes.
C'est ce qu'il se passe par exemple lors d'incorporations de sucres dans un NRP.
Nous avons déjà parlé dans le premier chapitre à la section TODO.
En ajoutant des gènes ou modifiant des enzymes du cluster de gènes certaines équipes réussissent à ajouter de nouveaux monomères ou à modifier certains monomères inclus~\cite{}.

TODO : schéma modification post-synthèse 

\cite{Recent advances} propose également d'aller plus loin en effectuant parfois cette modification avant l'assemblage NRPS.
Ils publient par exemple plusieurs modifications de la Pacidamycin qui ont été effectuées près assemblage.
Ce sont des enzymes modificatrices d'un monomères qui agissent avant la capture de celui-ci par le C-terminal.
La surface en contact lors de la capture et de l'assemblage n'étant pas modifiée, les monomères alternatifs sont intégrés de la même que l'original.
Certains monomères ne sont plus facilement modifiables une fois inclus du fait des contraintes structurelles et la modification de monomères pré-synthèse ouvre la voie vers de nouvelles structures peptidiques.



### Les modifications ponctuelles de synthétases
% Introduction of a Non-Natural Amino Acid into a Nonribosomal Peptide Antibiotic by Modification of Adenylation Domain Specificity
% Mapping the Limits of Substrate Specificity of the Adenylation Domain of TycA
% Reprogramming Nonribosomal Peptide Synthetases for “Clickable” Amino Acids

TODO : schéma modification module

La seconde possibilité de modification de NRP passe par la modification des synthétases.
Plus exactement par la modification d'un domaine A d'une synthétase.
Les travaux \cite{} partent du constat également fait par Stachelhaus~\cite{} que les domaines A sont spécifiques aux monomères qu'ils capturent.
En modifiant certains acides aminés composant un module A, la spécificité de celui-ci change.
Après quelques modifications bien effectuées la poche d'accueil du monomère est suffisamment modifée pour accueillir un nouveau type de monomère.
Les modifications à effectuer sont découvertes via des techniques d'évolution dirigée.
Les auteurs génèrent des mutations aléatoires (partiellement dirigées) sur les modules A puis ne gardent que ceux qui changent de fonction.
Par ce procédé, ils arrivent à capturer des monomères nouveaux parfois non naturels comme dans \cite{Introduction}.



### Les modifications de domaines de synthétases
% Reinvigorating natural product combinatorial biosynthesis with synthetic biology
% Harnessing the Biosynthetic Code: Combinations, Permutations, and Mutations

TODO : schéma échange module

Les modifications qui paraissent les plus évidentes sont celles qui font appel à des échanges de domaines.
Des exemples sont présentés au sein des articles \cite{}.
Intuitivement, nous pourrions nous dire qu'il est facile d'échanger par exemple deux modules A de deux synthétases comme on échangerait deux pièces de LEGO dans une construction.
Malheureusement, ces modifications ne sont pas si faciles car les modules doivent respecter des contraintes spatiales pour que le NRPS ait une cohérence structurelle.
De plus, certaines recombinaisons ne fonctionnent pas mais sans aucune raison à ce jour connue.

% A Subdomain Swap Strategy for Reengineering Nonribosomal Peptides

Pour outrepasser ce genre de dificultés, les auteurs de \cite{} procédent uniquement à un échange de sous domaine A.
Ils modifient une partie de la zone spécifique en essayant de préserver la structure globale du module.
Per cette technique, ils arrivent à modifier la forme de la poche et capter de nouveaux monomères.


### La création de peptide de novo

Nous arrivons désormais au graal de l'ingénieurie NRP : créer un peptide de toutes pièces.
Sans trop de surprise, il n'existe pour le moment aucune technique pour effectuer ce genre de tâche.
Comme nous l'avons vu précédamment, modifier un module A est déjà très difficile et nécessite beaucoup d'astuces.
Cependant, certains travaux cherchent déjà à concevoir des briques de base qui nous permettraient un jour de construire un peptide complet.
Ainsi, les travaux menés par K.M. Wilcoxen et al~\cite{} ont mené à la création d'un petit peptide synthétique mimiquant le comportement d'un domaine C.
Ils sont parvenu à lier deux monomères via leur peptide.
Nous sommes encore loin d'un domaine C universel fonctionnel mais c'est ce genre de travaux qui permettra de mener à bien cette quête du graal.


Nous avons globalement présenté plusieurs techniques d'ingénieurie de NRP sans quasiement laisser transparaitre de failles de ces techniques.
Cependant, quelle que soit la technique, rares sont les productions de NRP qui soient capable de passer à l'échelle.
Comme le dit si bien la revue, nous sommes pour le moment très bon en création de nombreux ``mauvais'' NRP.
En effet, les NRP créés sont soit très faiblement actifs soit très faiblement produits à cause des modifications.
Il reste encore beaucoup de chemin à parcourir pour un jour pouvoir produire des antibiotiques synthétiques issus de la pensée humaine.





## Aider les techniques de recombinaisons modulaires

Durant ma seconde année de thèse, je suis allé séjourner un mois au Danemark dans l'équipe dirigée Tilmann Weber afin de découvrir réciproquement nos travaux.
Son équipe a pour principale activité la découverte de nouveaux métabolites secondaires ainsi que la création d'outils dédiés à ces découvertes.
C'est cette équipe qui a créé, maintient et met à jour le logiciel antiSMASH (voir chapitre 1 section TODO).
Pour rappel, antiSMASH est un logiciel qui à partir d'un génome génère des annotations pour la découverte de métabolites secondaires.
En particulier, c'est la découverte de NRP qui motiva mon voyage.

Mon objectif en allant là bas était de préparer la création d'un outil qui fait l'inverse de antiSMASH, c'est à dire remonter du peptide vers le cluster de gène qui aurrait pu le produire.
L'outil idéal (mais évidemment irréalisable) permettrait à partir d'un NRP de générer du code génétique capable de produire ce NRP.
C'est dans cet optique que nous avons créé une première version d'un outil appelé Monomers2Clusters (m2c).
Cette section sera dédiée à l'explication des premiers algorithmes le constituant.


### Idée de base

L'idée est de modifier un peu le but de l'outil idéal pour en faire un outil réaliste.
Nous penssons que la première étape vers la création de NRP de novo est le mélange de gènes NRPS déjà existants.
Les techniques les plus prometteuses pour le moment sont celles qui utilisent un NRPS existant et le modifient.
m2c sera donc un logiciel d'aide à la création de nouveaux NRP.
Nous souhaitons proposer à l'utilisateur plusieurs clusters de gènes proches existants.
Le but est qu'il tente des recombinaisons de modules NRPS afin de produire son NRP d'intérêt.

TODO : schéma idée de recombinaison

Formellement, m2c sera un logiciel qui prend une structure monomérique en entrée et qui donne une liste ordonnée de clusters de gènes NRPS en sortie.
Cette liste sera ordonnée par proximité du NRP produit avec le NRP souhaité.
Pour commencer simplement, nous étudierons uniquement la présence ou absence de modules A dans la NRPS.
A partir des différents modules NRPS et des monomères présents dans le NRP d'intérêt nous établierons une distance.
Cette distance permettra d'ordonner les clusters les uns par rapport aux autres.
Prenons l'exemple d'un peptide d'intérêt contenant une leucine et de deux NRPS identiques excepté pour un domaine A.
Pour cet exemple, si l'un des deux clusters possède un domaine A incluant une leucine, le score de distance devra être plus faible que pour l'autre.


### Recherche par fingerprint

La première approche que nous avons utilisé est une approche par fingerprint.
En informatique, les fingerprints sont des structures représentant des données par une réduction de celles-ci à certains de leurs caractéristiques essentielles.
Dans notre cas, un fingerprint est un vecteur représentant la composition d'un NRP ou un NRPS.
Dans le cas des NRP c'est la composition en monomères qui nous intéresse et dans le cas des NRPS la composition en domaines A.
La composition peut être un simple compage de chacun des monomères, un comptage de tous les di-mères, de tous les tri-mères etc.

TODO : schéma fingerprint

Dans notre cas, le vecteur sera composé des comptages de monomères seuls et des comptages de di-mères (voir schéma TODO).
Pour le NRP, il est très smple d'obtenur ce vecteur.
Chaque monomère est compté indépendament puis chaque lien est compté comme un di-mère comportant les deux monomères liés.
Bien évidemment, un di-mère A-B est équivalent à un di-mère B-A.
Pour les NRPS, nous ne connaissons pas tous les voisinages.
La connaissance actuelle du fonctionnement des enzymes NRPS ne nous permet pas, à partir du génome, de dire si un cycle va s'effectuer à un endroit ou un autre.
Nous ne sommes pas non plus capable de donner des règles générales d'assemblage des différents sous peptides créés par différents gènes NRPS.
La première partie des compatges est facile à obtenir.
En analysant les domaines A, il est possible de déterminer leur spécificité (Via par exemple NRPSPredictor) et ainsi d'augmenter la valeur de la case correspondant au monomère dans le vecteur.
Pour ce qui est des di-mères, il faut analyser les gènes NRPS.
Deux modules A dans deux gènes différents ne doivent pas générer de di-mères.
Nous anajouton uniquement des dimère pour deux modules A successifs trouvé dans un même gène.

% Etude comparative de la distribution florale dans une portion des Alpes et du Jura

Une fois les vecteurs formés, il faut pouvoir comparer le fingerprint NRP aux fingerprints des clusters.
Pour cela, nous avons choisi de comparer les figerprints NRPS un à un et de calculer une valeur de distance.
Cette valeur de distance permettra de classer les clusters par proximité et de ainsi proposer les plus proche du NRP.
Pour générer cette distance il est nécessaire de prendre en compte à la fois les présences communes entre deux fingerprints mais également les divergeances.
Pour répondre à ce besoin, nous avons choisi d'utiliser une distance de Jaccard~\cite{}.
La distance de jacard compare la présence de critères communs entre les deux vecteurs au nombre de critères totaux.
Dans notre cas nous comparerons les monomères et di-mères communs à ceux divergeants.

\begin{equation}
  J(A,B) = \frac{A \cap B}{A \cup B}
\end{equatuion}

TODO : figure exemple Jaccard

TODO : Commenter l'exemple

TODO : dire que c'est naïf et qu'il faudrait changer le score.



### Recherche par isomorphismes de sous graphe

TODO : schéma SI NRP/NRPS

En constatant sur quelques exemple que la première méthode serait sans doute trop naïve, nous avons réfléchi à un second modèle.
Nous essayons de trouver des sous morceau du NRP qui pourraient être synthétisés par des clusters.
Nous cherchons donc des gènes qui fabriqueraient de un à plusieurs monomères du NRP.
Pour simplifier, nous imposerons que les gènes choisis ne produisent rien d'autre que des monomères du NRP d'intérêt.
Ce problème simplifié se réduit en problème d'isomorphisme de sous graphe.
Représentons chaque gène NRPS par un graphe linéaire dont les noeuds sont les spécificités des domaines A.
Dans ce cas, un gène d'intérêt est un gène dont le graphe monomérique linéaire est un ismorphisme de sous graphe du NRP.

Une fois différents morceaux NRPS sélectionnés, il faut encore les classer.
Pour les classer nous allons chercher à obtenir le maximum d'intérêt'.


### Tester les modèles

Afin de tester les modèles nous avons choisi de prendre des peptides réels.
A partir de ces peptides, nous espérons retrouver leur vrai cluster de gène au sein d'un ensemble de clusters.
Pour cela, il nous est nécessaire de constituer une base de données test.
Malheureusement, la constitution d'une telle base est très difficile.
Il existe très peu de sources de données mettant en relation des NRP constatés dans l'environnement avec des NRPS réels.
Nous devons constituer cette base par nous même.

La première piste que nous avions envisagé était de récupérer des données NRPS sûres (analysées à la main) et de les mettre en relation avec les données NRP de Norine.
Nous avons donc récupéré les données de gènes de MiBIG car la qualité des annotations nous intéressaient.
Cette source de données a été un double calvaire.
Premièrement, les données téléchargées ne sont pas normalisées.
Par exemple, les noms des monomères assemblés par un NRPS sont parfois complets et parfois résumés à quelques lettres.
Ces mêmes monomères peuvent également être présents sous plusieurs noms sans avoir aucun lien entre eux.
Enfin, les strructures de données (fichiers json) ne sont pas non plus tous structurés de la même manière.
Résultat, plusieurs données ont dues être écartées car trop contraignantes pour des récupération automatiques.
Le second problème (le plus problématique) est que quasiement aucun des clusters de gènes restant n'a le NRP correspondant sur Norine.
Les structures ne peuvent donc pas être controlées et confirmées.
C'est à la suite de tout ces problèmes que nous avons choisi de changer de source de données pour des données moins fiables.

A l'aide de Kai Blin (chercheur de l'équipe de Tilmann Weber), nous avons utilisé antiSMASH pour générer des annotations de NRPS sur l'ensemble des génomes de bactéries présentes sur le NCBI.
ce second jeu de données est beaucoup plus abondant que le premier mais pose également beaucoup plus de problèmes.
Il n'existe par exemple aucun lien entre les NRP de Norine et les génomes qui ont été analysés.
Il faudrait manuellement faire les rapprochement pour avoir les bionomes NRP/NRPS.
De plus, les anotations de antiSMASH ne sont que des prédictions et n'ont été vérifiées par personne.
Par exemple, de nombreux petits clusters de génes ne contiennent qu'un ou deux domaines A et il est difficile voir impossible de savoir si ils sont artefactuels ou mal annotés.

Nous avons fini par exécuter m2c en utilisant d'un côté tous les peptides de Norine et de l'autre toutes les annotations issues de antiSMASH.
N'ayant pas de liens directs entre les deux jeux de données, la vérification doit être effectuée à la main.
Nous avons sorti un top 10 des clusters les plus proches de chacun des peptides.
Après l'analyse de nombreux peptides le résultat est mitigé.

TODO : résultats


### Perspectives

Pour le moment les résultats ne permettent pas de dire qui du logiciel ou des données pose les problèmes observés.
Pour moi, les deux côtés doivent être améliorés pour parvenir à des résultats.
Les modèles naïf que nous avons développé nous paraissent pour le moment trop simple pour donner de bons résultats généraux mais ils devraient déjà mener à quelques résultats visibles.
D'un autre côté, il est nécessaire de constituer une base de connaissance NRP/NRPS solide afin de pouvoir tester correctement ces modèles ainsi que d'autres.
La constitution d'une telle base serait même bénéfique pour l'ensemble de la communauté.
Pour le moment, nous avons stoppé notre travail sur les modèles en attendant de constituer cette base.
C'est un travail en suspend qui nous parait plein d'intérêts et qui continuera d'être développé après cette thèse.

